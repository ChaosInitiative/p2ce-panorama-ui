<root>
	<styles>
		<include src="file://{resources}/styles/chaosstyles.sass" />
		<include src="file://{resources}/styles/controls/togglebutton.sass" />
		<include src="file://{resources}/styles/mainmenu.sass" />
	</styles>
	<scripts>
		<include src="file://{resources}/scripts/common/gameui.js" />
		<include src="file://{resources}/scripts/mainmenu.js" />
	</scripts>

	<snippets>
		<snippet name="MainMenuMovieSnippet">
			<Panel>
				<!-- Source is set in script. -->
				<Movie
					class="MainMenuModeOnly" 
					id="MainMenuMovie"
					src=""
					sound=""
					controls="none"
					repeat="true"
					hittest="false" />
			</Panel>
		</snippet>
	</snippets>

	<ChaosMainMenu class="InitialDisplay MainMenuRootPanel" hittest="false" useglobalcontext="true" oncancel="MainMenuController.onEscapeKeyPressed();">
		<ChaosBackbufferImagePanel id="BackbufferImagePanel" />

		<Panel id="MainMenuContainerPanel">

			<!-- The actual panel with input & focus -->
			<Panel id="MainMenuInput">
				
				<!-- Fills the entire screen. This is used as the backdrop -->
				<Panel id="MainMenuCore" blurrects="ChaosLoadingScreen">
					<Panel id="MainMenuBackground">

						<!-- Background video -->
						<Panel id="MainMenuMovieParent">
							<!-- Movie added/removed dynamically when changing the visibility of the main menu -->
						</Panel>
						<Panel id="MainMenuVanityParent">
							<!-- Vanity is not used but the engine needs this to exist -->
						</Panel>
					</Panel>

					<Panel id="MainMenuCampaignFrameParent">
						<Frame id="MainMenuCampaignFrame"> 
							<Panel class="Main">
								<Panel id="MainMenuPanel" class="MainMenuNavlistContainer">
									<Image id="MainMenuLogoDark"
											class=""
											src=""
											defaultsrc="file://{images}/menu/p2ce/logo_title.png"
											scaling="stretch-to-cover-preserve-aspect"/>
									<Panel id="NavListContainer" class="NavListContainer" >
										<TextButton id=""
												class="MainMenuNavlistItem MainMenuOnly"
												group="NavBar"
												onactivate="MainMenuController.onNewGameMenu()"
												text="Start New Game" />

										<TextButton id=""
												class="MainMenuNavlistItem MainMenuOnly"
												group="NavBar"
												onactivate="$.DispatchEvent( 'P2CEMainMenuPlayMap', 'sp_a2_triple_laser' );"
												text="Load Game" />

										<TextButton id=""
												class="MainMenuNavlistItem PauseMenuOnly"
												group="NavBar"
												onactivate="$.DispatchEvent( 'P2CEPauseMenuResume' );"
												text="Resume Game" />

										<TextButton id=""
												class="MainMenuNavlistItem MainMenuOnly"
												group="NavBar"
												onactivate="MainMenuController.onWorkshopMenuButtonPressed();"
												text="Manage Addons" />

										<TextButton id=""
												class="MainMenuNavlistItem"
												group="NavBar"
												onactivate="MainMenuController.onSettingsMenuButtonPressed();"
												text="Settings" />

										<TextButton id=""
												class="MainMenuNavlistItem PauseMenuOnly"
												group="NavBar"
												onactivate="GameInterfaceAPI.ConsoleCommand( 'disconnect' );"
												text="Exit to Main Menu" />
										<TextButton id=""
												class="MainMenuNavlistItem"
												group="NavBar"
												onactivate="MainMenuController.hideElement('#QuitMenu',false);"
												text="Quit" />
									</Panel>
								</Panel>
								<Panel class="MainMenuSubContainer MainMenuNavlistContainer Disabled" id="QuitMenu">
									<Label class="MainMenuQuitListLabel" text="Are you sure you want to quit?" />
									<TextButton id=""
										class="MainMenuQuitListItem"
										group="NavBar"
										onactivate="GameInterfaceAPI.ConsoleCommand('quit');"
										text="Yes" />
									<TextButton id=""
										class="MainMenuQuitListItem"
										group="NavBar"
										onactivate="MainMenuController.hideElement('#QuitMenu',true)"
										text="No" />
								</Panel>
							</Panel>
						</Frame>
					</Panel>
				</Panel>
			</Panel>
		</Panel>
		
		<Panel id="MainMenuButtonsWorkshopContent" class="MainMenuButtonsContent" hittest="true">
			<!-- todo: addons panel -->
			<Label style="align: center center;" text="Steam workshop functionality is not currently implemented." />
		</Panel>
		
		<Panel id="MainMenuButtonsNewGameContent" class="MainMenuButtonsContent Disabled">
			<Label class="MainMenuButtonsNewGameLabel" text="Start New Game" />
			<Panel id="MainMenuButtonsNewGameContainer">
				<Panel class="MainNewGameList" id="MainMenuButtonsNewGameList">
				</Panel>
				<Panel class="MainNewGamePanel" id="MainMenuButtonsNewGamePanel">
				<!-- <Label text="Chapters"/> -->
				</Panel>
			</Panel>
		</Panel>
		<!-- <Label class="MainMenuButtonsNewGameLabel" text="Start New Game" /> -->
		<Panel id="MainMenuButtonsSettingsContent" class="MainMenuButtonsContent" hittest="true">
			<!-- todo: complete settings panel -->
			<Panel id="MainMenuButtonsSettingsCategoryList">
				<TextButton class="MainMenuButtonsSettingsCategoryListEntry"
						group="MainMenuButtonsSettingsCategory"
						onactivate=""
						text="Audio" />
				<TextButton class="MainMenuButtonsSettingsCategoryListEntry"
						group="MainMenuButtonsSettingsCategory"
						onactivate=""
						text="Graphics" />
				<TextButton class="MainMenuButtonsSettingsCategoryListEntry"
						group="MainMenuButtonsSettingsCategory"
						onactivate=""
						text="Gameplay" />
				<TextButton class="MainMenuButtonsSettingsCategoryListEntry"
						group="MainMenuButtonsSettingsCategory"
						onactivate=""
						text="Keybinds" />
				<TextButton class="MainMenuButtonsSettingsCategoryListEntry"
						group="MainMenuButtonsSettingsCategory"
						onactivate=""
						text="Interface" />
			</Panel>
			<Panel id="MainMenuButtonsSettingsPropertyList">
				<Label class="MainMenuButtonsSettingsPropertyListCategoryLabel" text="Audio" style="margin-top: 0px; border-top-left-radius: 4px;" />
				<Panel class="MainMenuButtonsSettingsPropertyListCategory">
					<Panel class="MainMenuButtonsSettingsPropertyListLabeledProperty">
						<Label text="Master Volume:" />
						<ChaosSettingsSlider id="MainMenuButtonsSettingsProperty_MasterVolume" class="ChaosSettingsSlider__hidevalue MainMenuSettingsSlider" text="" max="1.0" min="0.0" invert="false" percentage="true" value100percent="1.0" convar="volume" constrainrange="true" />
					</Panel>
					<Panel class="MainMenuButtonsSettingsPropertyListLabeledProperty">
						<Label text="Music Volume:" />
						<ChaosSettingsSlider id="MainMenuButtonsSettingsProperty_MusicVolume" class="ChaosSettingsSlider__hidevalue MainMenuSettingsSlider" text="" max="1.0" min="0.0" invert="false" percentage="true" value100percent="1.0" convar="snd_volume_music" constrainrange="true" />
					</Panel>
					<Panel class="MainMenuButtonsSettingsPropertyListLabeledProperty">
						<Label text="Threaded Audio:" />
						<ToggleButton id="MainMenuButtonsSettingsProperty_ThreadedAudio" onactivate="MainMenuController.toggleCVar('snd_hrtf_async');" />
					</Panel>
				</Panel>
				<Label class="MainMenuButtonsSettingsPropertyListCategoryLabel" text="Graphics" />
				<Panel class="MainMenuButtonsSettingsPropertyListCategory">
					<Panel class="MainMenuButtonsSettingsPropertyListLabeledProperty">
						<Label text="Vertical Sync:" />
						<ToggleButton id="MainMenuButtonsSettingsProperty_VerticalSync" onactivate="MainMenuController.toggleCVar('mat_vsync');" />
					</Panel>
				</Panel>
				<Label class="MainMenuButtonsSettingsPropertyListCategoryLabel" text="Customization" />
				<Panel class="MainMenuButtonsSettingsPropertyListCategory">
					<Panel class="MainMenuButtonsSettingsPropertyListLabeledProperty">
						<Label text="Portal 1 Crosshair:" />
						<ToggleButton id="MainMenuButtonsSettingsProperty_PortalOneCrosshair" onactivate="MainMenuController.toggleCVar('portalgun_crosshair_mode');" />
					</Panel>
				</Panel>
				<Label class="MainMenuButtonsSettingsPropertyListCategoryLabel" text="Keybinds" />
				<Panel class="MainMenuButtonsSettingsPropertyListCategory">
					<Panel class="MainMenuButtonsSettingsPropertyListLabeledProperty">
						<Label text="Empty for now" />
					</Panel>
				</Panel>
				<Label class="MainMenuButtonsSettingsPropertyListCategoryLabel" text="Interface" />
				<Panel class="MainMenuButtonsSettingsPropertyListCategory">
					<Label text="Note: currently requires a restart" />
					<Panel class="MainMenuButtonsSettingsPropertyListLabeledProperty">
						<Label text="Quake Console:" />
						<ToggleButton id="MainMenuButtonsSettingsProperty_ToggleQuakeConsole" onactivate="MainMenuController.toggleStoredVar('p2ce.console.quake');" />
					</Panel>
				</Panel>
			</Panel>
		</Panel>

		<Panel id="MainMenuBetaDisplay">
			<Label id="MainMenuBetaDisplayHeader" text="Beta Main Menu" />
			<Label id="MainMenuBetaDisplaySubheader" text="Menu is not finalized and subject to change." />
		</Panel>

		<!-- Make sure these are at the bottom to get the z-order right -->
		<ChaosPopupManager id="PopupManager" onpopupsdismissed="" />
		<ContextMenuManager id="ContextMenuManager" />
		<ChaosTooltipManager id="TooltipManager" hittest="false" />

		<!-- Doesn't actually include the notifications, but we use its position to figure out where to show them -->
		<Panel id="SteamNotificationsPlaceholder" hittest="false" />
	</ChaosMainMenu>
</root>
